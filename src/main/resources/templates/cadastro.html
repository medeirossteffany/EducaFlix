<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cadastro - EducaFlix</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body class="auth-page">

<div class="auth-container auth-container-wide">
  <div class="auth-logo">EDUCAFLIX</div>
  <h2 class="auth-title">Criar Conta</h2>

  <div class="auth-alert-error" th:if="${erro}" th:text="${erro}"></div>

  <form method="post" action="/cadastro">
    <div class="auth-form-group">
      <label class="auth-label">Nome Completo</label>
      <input type="text" name="nome" class="auth-input" required
             th:value="${nome}" placeholder="Seu nome completo">
    </div>

    <div class="auth-form-group">
      <label class="auth-label">Email</label>
      <input type="email" name="email" class="auth-input" required
             th:value="${email}" placeholder="seu@email.com">
    </div>

    <div class="auth-form-group">
      <label class="auth-label">CPF</label>
      <input type="text" name="cpf" class="auth-input" required
             th:value="${cpf}" placeholder="000.000.000-00" maxlength="14">
    </div>

    <div class="auth-form-group">
      <label class="auth-label">Senha</label>
      <input type="password" name="senha" class="auth-input" required
             placeholder="Mínimo 6 caracteres">
    </div>

    <div class="auth-form-group">
      <label class="auth-label">Tipo de Conta</label>
      <select name="role" class="auth-select" required id="roleSelect">
        <option value="">Selecione...</option>
        <option value="ALUNO" th:selected="${role == 'ALUNO'}">Aluno</option>
        <option value="PROFISSIONAL" th:selected="${role == 'PROFISSIONAL'}">Profissional</option>
      </select>
    </div>

    <div class="auth-form-group" id="campoAreaInteresse" style="display: none;">
      <label class="auth-label">Área de Interesse</label>
      <input type="text" name="areaInteresse" class="auth-input"
             th:value="${areaInteresse}" placeholder="Ex: Programação, Design...">
    </div>

    <div class="auth-form-group" id="campoAreaAtuacao" style="display: none;">
      <label class="auth-label">Área de Atuação</label>
      <input type="text" name="areaAtuacao" class="auth-input"
             th:value="${areaAtuacao}" placeholder="Ex: Desenvolvedor, Professor...">
    </div>

    <div class="auth-form-group" id="campoCodigoProfessor" style="display: none;">
      <label class="auth-label">Código do Professor</label>
      <input type="text" name="codigoProfessor" class="auth-input"
             th:value="${codigoProfessor}" placeholder="Código único">
    </div>

    <button type="submit" class="auth-btn">Cadastrar</button>
  </form>

  <div class="auth-link">
    Já tem uma conta? <a href="/login">Faça login aqui</a>
  </div>
</div>

<script>
  const roleSelect = document.getElementById('roleSelect');
  const campoAreaInteresse = document.getElementById('campoAreaInteresse');
  const campoAreaAtuacao = document.getElementById('campoAreaAtuacao');
  const campoCodigoProfessor = document.getElementById('campoCodigoProfessor');

  roleSelect.addEventListener('change', function() {
    if (this.value === 'ALUNO') {
      campoAreaInteresse.style.display = 'block';
      campoAreaAtuacao.style.display = 'none';
      campoCodigoProfessor.style.display = 'none';
    } else if (this.value === 'PROFISSIONAL') {
      campoAreaInteresse.style.display = 'none';
      campoAreaAtuacao.style.display = 'block';
      campoCodigoProfessor.style.display = 'block';
    } else {
      campoAreaInteresse.style.display = 'none';
      campoAreaAtuacao.style.display = 'none';
      campoCodigoProfessor.style.display = 'none';
    }
  });

  if (roleSelect.value) {
    roleSelect.dispatchEvent(new Event('change'));
  }

  const cpfInput = document.querySelector('input[name="cpf"]');
  cpfInput.addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length > 11) value = value.slice(0, 11);

    if (value.length > 9) {
      value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{1,2})/, '$1.$2.$3-$4');
    } else if (value.length > 6) {
      value = value.replace(/(\d{3})(\d{3})(\d{1,3})/, '$1.$2.$3');
    } else if (value.length > 3) {
      value = value.replace(/(\d{3})(\d{1,3})/, '$1.$2');
    }

    e.target.value = value;
  });
</script>

</body>
</html>
